.TH elist 1W "2001.2.7" "WIN SYSTEM" "WIN SYSTEM"
.SH 名称
elist - トリガー・検測情報データベースを作る
.SH 形式
.TP
elist [\-huns] [\-o \fIoutfile\fR] [\-p \fIppfile\fR]
.I pickdir
.I pmonout
[\fItrgdir\fR [\fIdir1\fR [\fIdir2\fR [\fIdir3\fR]]]]
.LP
.SH 解説
elist は、pmon(1W) が生成したトリガーリストファイル
.I pmonout
からトリガー情報を読み込み、新しいものから順に１行１イベントの形式で、
(1)トリガー時刻、(2)検測状況、(3)マグニチュードの目安、
(4)トリガーした地域名のリスト、を標準出力に書き出します。
(1)のトリガー時刻は
.I pmonout
中の「on時刻」で、これは events(1W) が生成した
イベント波形ファイル名でも
あります。(2)の検測状況には、検測情報ファイルの
ディレクトリ
.I pickdir
からそのイベント波形ファイルに属する検測情報ファイルを探し、その
内容から(A)検測者名、(B)ラベル（メモ）、(C)検測レベルが書き出されます。
(A)と(B)は最初の５文字までが表示されます。(C)は"PHMM"の４文字で
表示され、それぞれの文字は読み取り値があること(P)、震源決定されて
いること(H)、マグニチュードが決定されていること(M)、メカニズムが決定
されていること(M)、を表します。それらの文字のかわりに"."があると、
対応する情報がない、または決定されてないことを示します。１つの
そのイベント波形ファイルに属する検測情報ファイルが複数あるときは、
その数だけ(2)すなわち(A)〜(C)が書き並べられます。
(3)のマグニチュードの目安はトリガー継続時間から経験式で求められ、
マグニチュードが星の数で表されます。(4)のトリガーした地域名のリストは、
.I pmonout
の on行と off行から得られるもので、トリガーした時間順に書き並べられます。
.LP
.I trgdir
を指定すると、もしそのディレクトリにそのトリガーに対応する
イベント波形ファイルがない場合、(1)のトリガー時刻（＝イベント波形ファイル名）の
後ろに "x" が付けられます。また、(2)の(B)のラベルが "NOISE" であるとき、
elist は
.I trgdir
にある、対応するイベント波形ファイルおよびそれに付属するチャネル表ファイル
（〜.ch）とビットマップファイル（〜.sv）を削除します。
通常
.I trgdir
として指定されるのは /dat/trg です。
.LP
ディレクトリ
.I dir1 ...
が指定されているとき、このディレクトリのいずれかの中
（ただしディレクトリ名が "/" で終わっている場合はその下のすべての
ディレクトリの中）にイベント
波形ファイルと同じ名前をもつファイルがあると、(1)のトリガー時刻
（＝イベント波形ファイル名）の後ろに "&" が付けられます。
通常
.I dir1 ...
として指定されるのは /dat/auto, /dat/autos/, /dat/request/ 等です。
.LP
elist はイベント収録サーバーで _update(1W) 等の中で使われています。
.LP
elist は引数なしで起動すると簡単な使用法を表示します。elist は
作業用に一時ファイルを /tmp に作ります。また、\-n オプションを
指定しない場合は tail コマンドを利用しますので、tail コマンドが
実行可能である(パスが通っている)必要があります。
.LP
elist の出力の例は次のようなものです。
.nf
---------------------------------------------------
YYMMDD hhmmss  picker      PHMM 1.....7   region(s)
 date   time                       M      triggered
---------------------------------------------------
010207.100518  auto  M1.9  PHM. ***      C-CHUGO BUNGO-S SHIKOKU
010207.090937  auto  FAIL  P... **       BUNGO-S 
010207.083357  reiko .     PHM. ***      C-CHUGO 
.fi
.SH オプション
.TP
\-u
簡単な使用法を表示します。
.TP
\-h
付属する検測情報がすべて 'NOISE' ラベル付きであるようなイベントに
ついては、出力の行末に '#' が付加されますが、このオプションを指定すると
このようなイベントの行はあらかじめ取り除かれて出力されません。
.TP
\-o
出力を標準出力でなくて
.I outfile
に書き出します。
.TP 
\-n
出力を新しいもの順ではなくて、古いもの順(時間順)にします。
.TP 
\-s
.I trgdir
が指定されても、対応するイベント波形ファイルおよびそれに付属する
チャネル表ファイル（〜.ch）とビットマップファイル（〜.sv）を削除しません。
.TP
\-p
検測情報ファイル(pickファイル)とイベント波形ファイルの対応表をファイル
.I ppfile
に作成します。これは elist実行上の副産物としてできるものです。
sort コマンドを利用しますので、sort コマンドが実行可能である
(パスが通っている)必要があります。
フォーマットは井出さんによる ppリスト(pktemp.XXXX)と同じで、
次の例のようなものです。
.IP "" -5
.nf
-----------------------------------------------------------------------------
pickfile          trgfile       picker P   S   M Lat.  Lon.   Dep. M  nearest
-----------------------------------------------------------------------------
010201.000053.916 010201.000100 inou   8   6   8 32.90 132.55  26 M1.6  TKD
010201.010054.014 010201.010101 inou  16  15  16 33.56 133.98  12 M2.0  HJO
010201.012318.000 010201.012338 inou   0   0   0 -     -       -    -    -
.fi
.SH ソース
.TP
`elist.c'
.SH 関連事項
_update(1W), pmon(1W)
