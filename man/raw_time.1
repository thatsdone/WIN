.\" $Id: raw_time.1,v 1.2 2016/01/05 06:38:46 uehira Exp $
.TH raw_time 1W "2015.12.28" "WIN SYSTEM" "WIN SYSTEM"
.SH 名称
raw_time - RAW 形式データの時間ずらしフィルター
.SH 形式
raw_time [\-\fBBD\fR]
[
.I \-s 4|5|5f
]
.I inkey
.I outkey
.I shmsize
.I chfile
[
.I logfile
]
.LP
raw_timed [\-\fBB\fR]
[
.I \-s 4|5|5f
]
.I inkey
.I outkey
.I shmsize
.I chfile
[
.I logfile
]
.LP
.SH 解説
raw_time は、キー
.I inkey
の共有メモリ・セグメントに巡回的に書き込まれている raw 形式のデータを
読み込み、
.I chfile
にしたがって時刻をずらし、その結果をキー
.I outkey
で与えられる共有メモリ・セグメントに書き出します。キー
.I outkey
をもつ共有メモリ・セグメントが存在しない場合は、大きさ
.I shmsize
(KB)の共有メモリ・セグメントが作られます。すでに存在している場合は、そ
のサイズが
.I shmsize
(KB)よりも小さいとエラーになります。共有メモリ・キーは32ビットの整数値
です。
.LP
raw_timed は daemon モードで起動します。
.LP
ログファイル名
.I logfile
を指定すると、ここに動作ログがとられ、
指定しないとログ情報は標準出力に
送られます(ただし、daemon モードで動い
ている時は syslogd(8) に送られます)。ログファイルは書き込みのたび毎に
オープン／クローズされます。
.LP
.I chfile
は win(1W) に記述されているチャンネル表ファイルの[1]から[3]の情報を抜
き出したもの記述したものです([4]から先があっても無視するだけです)。つ
まり、１行に１つずつ、16進数のチャンネル番号、収録のフラグ、時刻ずらし
量(ms単位・整数値)をスペースまたはタブで記述します。時刻ずらし量が正の
時、データのタイムスタンプから時刻ずらし量分だけ引き、負の場合は足しま
す。これは、チャンネル表ファイルの[3]のフィールドが回線遅延時間を表わ
していることと整合性をとるためです。
.I outkey
には、収録フラグが0でないもの、かつ、遅延時間が0でないチャンネルのみが
出力されます。また、先頭が '#' である行も無視されます。raw_time プロセ
スはハングアップシグナルを受け取ると、チャネルファイルを読み直します。
.LP
共有メモリ
.I inkey
上の形式は、時間順整列されたもの(order(1W)参照)でなくてはいけません。
共有メモリ
.I outkey
の形式は「書き込み時刻付き」の形式(recvt(1W)参照)になります。
.LP
raw_time は、引数なしで起動すると簡単な使用法を表示します。
.LP
.SH オプション
.IP "\fB\-B" 5
出力共有メモリに「ブロック末尾にもブロックサイズを
持つ形式」で書き込みます。これについては recvt(1W), order(1W) を
参照してください。
.IP "\fB\-D" 5
daemon モードで起動します。
.IP "\fB\-s \fImode" 5
書き込みデータのサンプルサイズが
.I 4 バイト
の場合のサンプルサイズ情報のモードを指定します。
.nf
4 : サンプルサイズ情報を 4 にします。
5 : サンプルサイズ情報を 5 にします。
5f : サンプルサイズが 4 バイト長以外についてもサンプルサイズ情報を 5
     にします。つまり、常に圧縮の無い固定長データとなります。
.LP
.SH ソース
.TP
`raw_time.c'
.SH 関連事項
win(1W), order(1W), recvt(1W), wtime(1W)
