.TH recvts 1W "2000.8.14" "WIN SYSTEM" "WIN SYSTEM"
.SH 名称
recvts - HDLCボードからの win 形式データの受信
.SH 形式
recvts
.I shmkey
.I shmsize
[
.I chfile
[
.I logfile
]]
.LP
.SH 解説
recvts は、PCのRS-422インターフェース用HDLCボード(白山工業製)に
入力される衛星システム配信系 6Mbps回線の win 形式 データを受信し、キー
.I \ shmkey
で与えられる共有メモリ・セグメントに（巡回的に）書き込みます。
そのキーをもつ共有メモリ・セグメントが存在しない場合は、大きさ
.I \ shmsize
\ (KB) の共有メモリ・セグメントが作られます。すでに存在している場合は、
そのサイズが
.I \ shmsize
\ (KB) よりも小さいとエラーになります。
UDP ポート番号は16ビットの整数値、共有メモリ・キーは32ビットの
整数値です。チャネルファイル
.I \ chfile
が与えられた場合は、その中にリストされたチャネルのデータだけが
受信されます。ただしチャネルファイル名の先頭に '\-' を付けたときは、
そのファイルにリストされた以外の全チャネルのデータが受信されます。
.I chfile
が与えられないか、または '\-' である場合は、全チャネルが受信されます。
.LP
ログファイル名
.I \ logfile
を指定すると、ここに動作ログがとられ、
指定しないとログ情報は標準出力に
送られます。ログファイルは書き込みのたび毎に
オープン／クローズされます。動作ログにはデータ量に関する統計が
含まれます。これは起動時およびrecvtsがHUPシグナルを受けるたびに
ログに書き出されますが、その内容は、前回書き出して以降の、
パケット数(np)、バイト(nb)、および測定期間の長さ(per)です。
recvtsがHDLC回線から受け入れるデータは種別 'A1'のパケットだけですが、
統計情報として測定されるデータ量は、HDLCフレームのデータ部分全体
についてで、すべてのパケット種別を含むものです。したがって、
この情報から回線の正味の利用率を見積もることができます。
.br
大学の衛星システムの配信系の場合、パケットサイズは
平均3.7KB程度になっています。HDLCフレームには前後に
フラグ等がつきますが、この程度の大きなパケットサイズだと
その分のオーバーヘッドは 1%以下でしょう。またHDLCでは、1 が５個続くと
次に必ず余分の0 を１個挿入しますが、それによる増加も
確率的に 1%以下です。
.LP
recvts は、自ホストの内部時計よりも+/\-30分以上離れた時刻の
データパケットは受け付けません。したがって recvts を走らせる
ホストでは、時計をある程度正確に合わせておく必要があります。
.LP
recvts が受信するデータは、一般に記録の時間順に送られてくるとは
限りません。この場合、recvts が書き込んだ共有メモリ上でも、データは
時間順にはなりません。order(1W) はこれを時間順に並べ変えます。
.LP
recvts は引数なしで起動すると簡単な使用法を表示します。
.SH HDLC上の形式
データはHDLC パケットで伝送され、配信系回線の拡張形式をもっています。
recvts はパケット種別 'A1' のパケットだけを受け入れます。
.SH 再送プロトコル
配信系RS-422回線は一方通行で、再送機能はありません。
.SH 共有メモリ上の形式
recvts が共有メモリに書き込むデータの形式については、recvt(1W)を
参照してください。
.SH オプション
.TP 
なし
.SH ソース
.TP 
`recvts.c'
.SH 関連事項
winformat(1W), recvt(1W), order(1W)
.SH 動作環境
recvts は、FreeBSD上で動作し、HDLCデバイス /dev/brhdlc0 をオープンして
ここからデータを読み込みます。
