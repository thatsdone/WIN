.TH shmdump 1W "2002.1.15" "WIN SYSTEM" "WIN SYSTEM"
.SH 名称
shmdump - 共有メモリ・セグメント上のデータのモニタ
.SH 形式
shmdump [\-\fBamoqwz\fR] [\-\fBs\fI\ sec\fR] [\-\fBf\fI\ file\fR]
.I shmkey
[
.I ch ...
]
.SH 解説
shmdump は、キー
.I \ shmkey
で与えられる共有メモリ・セグメントに巡回的に書き込まれている
データの、各ブロックの最初の部分を読んでダンプしていきます。
チャネルのリスト
.I ch\ ...
を指定すると、指定されたチャネルはすべて、１行１チャネルの形式で
ダンプされます。
shmdump は共有メモリ上のブロック形式として、「書き込み時刻」付きの
もの（recvt(1W)参照）および「書き込み時刻」無しのもの
（order(1W)参照）のどちらでも、自動的に判別して読むことができます。
表示形式は以下のとおりです。
.SH 「書き込み時刻」無しの場合
まずブロックサイズ（バイト）、次にタイムスタンプの時刻（年〜秒）を12桁で、
次に最初のチャネルブロックの先頭８バイトを16進数で表示します。
.SH 「書き込み時刻」付きの場合
まずブロックサイズ（バイト）、続いて「書き込み時刻(RT=RealTime)」を年〜秒の
12桁で、その後にそれとタイムスタンプの時刻(TS=TimeStamp)との差
(RT-TS)を秒単位で表示し、次にタイムスタンプの時刻(TS)を年〜秒の12桁で、
次に最初のチャネルブロックの先頭８バイトを16進数で表示します。
.LP
上のいずれの場合でも、特定のチャネルを指定しないときは、
１ブロック（１秒分）の情報が１行に表示されますが、
チャネルのリストを指定したときは、１つの秒ブロックに複数のチャネルが入って
いても、先頭のタイムスタンプが各行にコピーされて出力されます。
.SH オプション
.IP "\fB\-a" 5
すべてのチャネルについてダンプします。
.IP "\fB\-m" 5
MON形式のデータを扱います。データがMON形式のときはこれを
指定しなければなりません。MON形式については raw_mon(1W)を
参照してください。
.IP "\fB\-a" 5
すべてのチャネルについてダンプします。
.IP "\fB\-o" 5
指定されたチャネル(\fB\-a\fPオプションが指定されたときは全チャネル)
のデータをWIN形式のまま、標準出力に書き出します。
このとき、通常の(１行１チャネルの)ダンプ出力は標準エラー出力に
書き出されます。
.IP "\fB\-q" 5
１行１チャネルの形式のダンプ出力を抑制します。ふつうは\fB\-o\fPオプションと
ともに指定されます。
.IP "\fB\-w" 5
指定されたチャネル(\fB\-a\fPオプションが指定されたときは全チャネル)
のデータをWIN形式のまま一時ファイルに書き出し、続いてwin(1W)を起動します。
一時ファイルが作られるのは、環境変数 TMP に設定されたディレクトリ、それが
なければ 環境変数 TEMP に設定されたディレクトリ、それもなければカレント
ディレクトリです。このオプションは \fB\-o\fPオプションを含みます。
.IP "\fB\-z" 5
データを共有メモリセグメントの先頭から読み出します。これが指定されないと、
データは最新の書き込み部分から(それの書き込みが終るのを待って)読み出されます。
.IP "\fB\-s \fIsec" 5
.I sec
秒間実行後、終了します。ふつうはこれで約
.I sec
秒分のデータがダンプされる
ことになります。これを指定しない場合は、shmdumpは割り込みがあるまで
止まりません。
.IP "\fB\-f \fIfile" 5
チャネルのリストをファイル
.I file
から読み込みます。ファイル名の代わりに
"\-" を指定すると、標準入力から読み込みます。
リストは、空白、タブまたは改行で区切られた、16進数のチャネル番号です。
.SH 使用例
.nf
shmdump 11 0200
  チャネル0200だけを(あれば必ず)リストする

shmdump 11 0200 0201 0202
  チャネル0200,0201,0202を(あれば必ず)リストする

echo 0200 0201 0202 | shmdump -f - 11
  上と同じ。チャネルのリストを標準入力から与える

shmdump -f aso.ch 11
  チャネルファイル aso.ch にあるチャネルを(あれば必ず)リストする

shmdump -of aso.ch 11 > aso.dat
  チャネルファイル aso.ch にあるチャネルの波形を aso.datに出力

shmdump -of aso.ch -s 10 11 > aso.dat
  チャネルファイル aso.ch にあるチャネルの波形を約10秒分 aso.datに出力

shmdump -wf aso.ch -s 10 11
  チャネルファイル aso.ch にあるチャネルの波形を約10秒分winで表示

grep -w HIT /dat/etc/channels.tbl|shmdump -ws 10 -f - 11
  観測点 HIT の波形を約10秒分winで表示
.fi
.SH ソース
.TP
`shmdump.c'
.SH 関連事項
winformat(1W), recvt(1W), order(1W), win(1W), raw_mon(1W)
